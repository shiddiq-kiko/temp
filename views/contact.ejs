<!DOCTYPE html>
<html lang="en">
    <head>
        <%- include('partials/head.ejs')  %>
    </head>
    <body class="bg">
        <%- include('partials/header.ejs')  %>
        <main>
            <div class="container">
                <div class="row">
                    <div class="col-lg">
                        <br><br>
                        <table class="table text-center ">
                            <thead class="table-dark text-light">
                                <tr>
                                    <th colspan="9">
                                        <h1>Contacts</h1>
                                        <a href="/contacts/add">add new contact</a>
                                    </th>
                                </tr>
                                <tr>
                                    <th>ID</th>
                                    <th>First Name</th>
                                    <th>Last Name</th>
                                    <th>Phone Number</th>
                                    <th>Phone Number 2</th>
                                    <th>Work Period</th>
                                    <th>Email</th>
                                    <th>Phases</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody class="table-light table-stripped">
                                <% result.map(data => { %> 
                                    <tr>
                                        <td><%= data.id %></td>
                                        <td><%= data.first_name %></td>
                                        <td><%= data.last_name %></td>
                                        <td><%= data.phone_number %></td>
                                        <td><%= data.phone_number_2 %></td>
                                        <td><%= data.work_period %></td>
                                        <td><%= data.email %></td>
                                        <% const temp =[] %>
                                        <% data.Phases.map(dataPhase => { %> 
                                            <% temp.push(dataPhase.name) %>
                                        <%})%>
                                        <td>
                                            <%= temp.sort().join(', ') %>
                                        </td>
                                        <td><a href="/contacts/edit/<%= data.id %>">Edit</a> | <a href="/contacts/delete/<%= data.id %>" onclick="return confirm('Do You Want to Delete this Contact?')">Delete</a></td>
                                    </tr>
                                <%})%>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
        <%- include('partials/jquery.ejs') %>
    </body>
</html>